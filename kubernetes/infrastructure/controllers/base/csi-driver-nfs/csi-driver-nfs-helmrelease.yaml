---
apiVersion: helm.toolkit.fluxcd.io/v2
kind: HelmRelease
metadata:
  name: csi-driver-nfs
  namespace: csi-driver-nfs
spec:
  chart:
    spec: 
      chart: csi-driver-nfs
      version: "~4.12.0"
      sourceRef:
        kind: HelmRepository
        name: csi-driver-nfs
        namespace: flux-system
      reconcileStrategy: ChartVersion
  valuesFrom:
    - kind: ConfigMap
      name: csi-driver-nfs-values
      valuesKey: values.yaml

  releaseName: csi-driver-nfs
  
  interval: 6h0m0s
  # timeout: 10m0s

  install:
    createNamespace: true
    crds: CreateReplace
    remediation:
      retries: 2
      remediateLastFailure: true

  upgrade:
    remediation:
      retries: 2
      remediateLastFailure: true
